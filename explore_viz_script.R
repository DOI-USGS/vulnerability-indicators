## Exploratory viz, EA 12/28/2023
library(targets)
library(tidyverse)
library(plotly)

tar_load(p2_agree_evid_stats)

p2_agree_evid_avg_aggregated <- p2_agree_evid_stats |> 
  group_by(determinant) |> 
  summarize(avg_level_agreement = mean(level_agreement)) |> 
  mutate(determinant = str_to_title(determinant))

plt <- ggplot(p2_agree_evid_avg_aggregated, aes(y = determinant, x = avg_level_agreement, 
                                                size = avg_level_agreement, color = determinant,
                                                text = paste("Determinant:", determinant, "<br>",
                                                             "Average Level of Agreement:", 
                                                             round(avg_level_agreement), "%"))) +
  geom_point(alpha = 0.7) +
  labs(x = "Average Level of Agreement (%)",
       y = "Determinants") +
  theme_minimal() +
  theme(axis.text.y = element_blank(),
        legend.position = "none") +
  scale_x_continuous(limits = c(0, 100))

ggplotly(plt, tooltip = "text")
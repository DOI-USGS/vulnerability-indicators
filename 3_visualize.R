source('3_visualize/src/plot_utils.R')
# For case studies approach: select one demographic characteristic (hispanic/latino), 
p3_targets <- list(
  tar_target(
    p3_med_income_png,
    plot_census_map(
      census_data = p2_perc_census_acs5_layers_sf[[2]],
      percent_leg = FALSE,
      var = 'estimate',
      conus_sf = p1_conus_sf,
      outfile_path = "3_visualize/out/med_income_census_2022.png",
      leg_title = "Median household income, 2022",
      viz_config_df = p0_viz_config_df,
      viz_config_pal = p0_viz_config_pal$pal_positive,
      width = p0_viz_config_df$width_desktop,
      height = p0_viz_config_df$height_desktop,
      font_size  = p0_viz_config_df$font_size_desktop,
      barwidth = 40,
      barheight = 2
    ),
    format = "file"
  ),
  tar_target(
    p3_perc_household_income_png,
    plot_census_map(
      census_data = p2_census_acs5sub_income_data[[1]],
      percent_leg = TRUE,
      var = 'percent',
      conus_sf = p1_conus_sf,
      outfile_path = "3_visualize/out/perc_household_income_2022.png",
      leg_title =  "Percent allocated household income\nin the past 12 months, 2022",
      viz_config_df = p0_viz_config_df,
      viz_config_pal = p0_viz_config_pal$pal_positive,
      width = p0_viz_config_df$width_desktop,
      height = p0_viz_config_df$height_desktop,
      font_size  = p0_viz_config_df$font_size_desktop,
      barwidth = 40,
      barheight = 2
    ),
    format = "file"
  ),

  tar_target(
    p3_tot_latino_png,
    plot_census_map(
      census_data = p2_perc_census_acs5_layers_sf[[4]],
      percent_leg = FALSE,
      var = 'estimate',
      conus_sf = p1_conus_sf,
      outfile_path = "3_visualize/out/tot_latino_census_2022.png",
      leg_title =  "Total Latino, 2022",
      viz_config_df = p0_viz_config_df,
      viz_config_pal = p0_viz_config_pal$pal_positive,
      width = p0_viz_config_df$width_desktop,
      height = p0_viz_config_df$height_desktop,
      font_size  = p0_viz_config_df$font_size_desktop,
      barwidth = 40,
      barheight = 2
    ),
    format = "file"
  ),

  tar_target(
    p3_perc_latino_png,
    plot_census_map(
      census_data = p2_perc_census_acs5_layers_sf[[4]],
      percent_leg = TRUE,
      var = 'percent',
      conus_sf = p1_conus_sf,
      outfile_path = "3_visualize/out/perc_latino_census_2022.png",
      leg_title = "Percent Latino, 2022",
      viz_config_df = p0_viz_config_df,
      viz_config_pal = p0_viz_config_pal$pal_positive,
      width = p0_viz_config_df$width_desktop,
      height = p0_viz_config_df$height_desktop,
      font_size  = p0_viz_config_df$font_size_desktop,
      barwidth = 40,
      barheight = 2
    ),
    format = "file"
  ),


  # Household related maps
  tar_target(
    p3_total_households_png,
    plot_census_map(
      census_data = p2_census_acs5sub_household_data[[1]],
      percent_leg = FALSE,
      var = 'estimate',
      conus_sf = p1_conus_sf,
      outfile_path = "3_visualize/out/tot_households_2022.png",
      leg_title = "Total households, 2022",
      viz_config_df = p0_viz_config_df,
      viz_config_pal = p0_viz_config_pal$pal_positive,
      width = p0_viz_config_df$width_desktop,
      height = p0_viz_config_df$height_desktop,
      font_size  = p0_viz_config_df$font_size_desktop,
      barwidth = 40,
      barheight = 2
    ),
    format = "file"
  ),
  tar_target(
    p3_female_households_png,
    plot_census_map(
      census_data = p2_census_acs5sub_household_data[[2]],
      percent_leg = FALSE,
      var = 'estimate',
      conus_sf = p1_conus_sf,
      outfile_path = "3_visualize/out/tot_female_households_2022.png",
      leg_title = "Total female households, 2022",
      viz_config_df = p0_viz_config_df,
      viz_config_pal = p0_viz_config_pal$pal_positive,
      width = p0_viz_config_df$width_desktop,
      height = p0_viz_config_df$height_desktop,
      font_size  = p0_viz_config_df$font_size_desktop,
      barwidth = 40,
      barheight = 2
    ),
    format = "file"
  ),
  tar_target(
    p3_median_rent_png,
    plot_census_map(
      census_data = p2_census_acs5sub_household_data[[3]],
      percent_leg = FALSE,
      var = 'estimate',
      conus_sf = p1_conus_sf,
      outfile_path = "3_visualize/out/median_rent_2022.png",
      leg_title = "Median gross rent, 2022",
      viz_config_df = p0_viz_config_df,
      viz_config_pal = p0_viz_config_pal$pal_neg,
      width = p0_viz_config_df$width_desktop,
      height = p0_viz_config_df$height_desktop,
      font_size  = p0_viz_config_df$font_size_desktop,
      barwidth = 40,
      barheight = 2
    ),
    format = "file"
  ),
  # Mobile maps
  tar_target(
    p3_med_income_mobile_png,
    plot_census_map(
      census_data = p2_perc_census_acs5_layers_sf[[2]],
      percent_leg = FALSE,
      var = 'estimate',
      conus_sf = p1_conus_sf,
      outfile_path = "3_visualize/out/med_income_census_2022_mobile.png",
      leg_title = "Median household income, 2022",
      viz_config_df = p0_viz_config_df,
      viz_config_pal = p0_viz_config_pal$pal_positive,
      width = p0_viz_config_df$width_mobile,
      height = p0_viz_config_df$height_mobile,
      font_size  = p0_viz_config_df$font_size_mobile,
      barwidth = 40,
      barheight = 3
    ),
    format = "file"
  ),
  tar_target(
    p3_perc_household_income_mobile_png,
    plot_census_map(
      census_data = p2_census_acs5sub_income_data[[1]],
      percent_leg = TRUE,
      var = 'percent',
      conus_sf = p1_conus_sf,
      outfile_path = "3_visualize/out/perc_household_income_2022_mobile.png",
      leg_title =  "Percent allocated household income\nin the past 12 months, 2022",
      viz_config_df = p0_viz_config_df,
      viz_config_pal = p0_viz_config_pal$pal_positive,
      width = p0_viz_config_df$width_mobile,
      height = p0_viz_config_df$height_mobile,
      font_size  = p0_viz_config_df$font_size_mobile,
      barwidth = 40,
      barheight = 3
    ),
    format = "file"
  ),
  
  tar_target(
    p3_tot_latino_mobile_png,
    plot_census_map(
      census_data = p2_perc_census_acs5_layers_sf[[4]],
      percent_leg = FALSE,
      var = 'estimate',
      conus_sf = p1_conus_sf,
      outfile_path = "3_visualize/out/tot_latino_census_2022_mobile.png",
      leg_title =  "Total Latino, 2022",
      viz_config_df = p0_viz_config_df,
      viz_config_pal = p0_viz_config_pal$pal_positive,
      width = p0_viz_config_df$width_mobile,
      height = p0_viz_config_df$height_mobile,
      font_size  = p0_viz_config_df$font_size_mobile,
      barwidth = 40,
      barheight = 3
    ),
    format = "file"
  ),
  
  tar_target(
    p3_perc_latino_mobile_png,
    plot_census_map(
      census_data = p2_perc_census_acs5_layers_sf[[4]],
      percent_leg = TRUE,
      var = 'percent',
      conus_sf = p1_conus_sf,
      outfile_path = "3_visualize/out/perc_latino_census_2022_mobile.png",
      leg_title = "Percent Latino, 2022",
      viz_config_df = p0_viz_config_df,
      viz_config_pal = p0_viz_config_pal$pal_positive,
      width = p0_viz_config_df$width_mobile,
      height = p0_viz_config_df$height_mobile,
      font_size  = p0_viz_config_df$font_size_mobile,
      barwidth = 40,
      barheight = 3
    ),
    format = "file"
  ),
  tar_target(
    p3_total_households_mobile_png,
    plot_census_map(
      census_data = p2_census_acs5sub_household_data[[1]],
      percent_leg = FALSE,
      var = 'estimate',
      conus_sf = p1_conus_sf,
      outfile_path = "3_visualize/out/tot_households_2022_mobile.png",
      leg_title = "Total households, 2022",
      viz_config_df = p0_viz_config_df,
      viz_config_pal = p0_viz_config_pal$pal_positive,
      width = p0_viz_config_df$width_mobile,
      height = p0_viz_config_df$height_mobile,
      font_size  = p0_viz_config_df$font_size_mobile,
      barwidth = 40,
      barheight = 3
    ),
    format = "file"
  ),
  tar_target(
    p3_female_households_mobile_png,
    plot_census_map(
      census_data = p2_census_acs5sub_household_data[[2]],
      percent_leg = FALSE,
      var = 'estimate',
      conus_sf = p1_conus_sf,
      outfile_path = "3_visualize/out/tot_female_households_2022_mobile.png",
      leg_title = "Total female households, 2022",
      viz_config_df = p0_viz_config_df,
      viz_config_pal = p0_viz_config_pal$pal_positive,
      width = p0_viz_config_df$width_mobile,
      height = p0_viz_config_df$height_mobile,
      font_size  = p0_viz_config_df$font_size_mobile,
      barwidth = 40,
      barheight = 3
    ),
    format = "file"
  ),
  tar_target(
    p3_median_rent_mobile_png,
    plot_census_map(
      census_data = p2_census_acs5sub_household_data[[3]],
      percent_leg = FALSE,
      var = 'estimate',
      conus_sf = p1_conus_sf,
      outfile_path = "3_visualize/out/median_rent_2022_mobile.png",
      leg_title = "Median gross rent, 2022",
      viz_config_df = p0_viz_config_df,
      viz_config_pal = p0_viz_config_pal$pal_neg,
      width = p0_viz_config_df$width_mobile,
      height = p0_viz_config_df$height_mobile,
      font_size  = p0_viz_config_df$font_size_mobile,
      barwidth = 40,
      barheight = 3
    ),
    format = "file"
  )
)